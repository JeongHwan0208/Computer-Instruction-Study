# Chapter 06 메모리와 캐시 메모리

### 06-1 RAM의 특징과 종류

**RAM의 특징**

![5-1](https://github.com/JeongHwan0208/Computer-Instruction-operating-system/blob/main/Linux/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%20image/5-1.jpg)

**휘발성 저장 장치(RAM)** : 전원을 끄면 저장된 내용이 사라지는 저장 장치, 실행할 대상을 저장한다.

**비휘발성 저장 장치(보조 기억 장치)** : 전원이 꺼져도 저장된 내용이 유지되는 저장 장치, 보관할 대상을 저장한다.



**RAM의 용량과 성능**

RAM 용량이 크면 많은 프로그램들을 동시에 빠르게 실행하는데 유리하다. 하지만 RAM용량이 무지막지하게 크다고 프로그램 실행 속도가 그에 비례하여 빨라지진 않는다.



**RAM의 종류**

***DRAM(Dynamic RAM)***

DRAM은 시간이 지나면 저장된 데이터를 재활성화(다시 저장)해야 한다. 이런 단점에도 불구하고 우리가 일반적으로 메모리로써 사용하는 RAM은 DRAM이다. 그 이유는 소비 전력이 비교적 낮고, 저렴하고, 집적도가 높기 때문에 대용량으로 설계하기가 용이하기 때문이다.

***SRAM(Static RAM)***

SRAM은 시간이 지나도 저장된 데이터가 사라지지 않는다. 주기적으로 데이터를 재활성화할 필요가 없다. 그리고 SRAM은 DRAM보다 일반적으로 속도가 빠르다. 하지만 일반적으로 SRAM보다 DRAM을 RAM으로 사용한다. SRAM은 DRAM보다 집적도가 낮고, 소비 전력도 크며, 가격도 더 비싸기 때문이다.

|           |      DRAM       |    SRAM     |
| :-------: | :-------------: | :---------: |
|  재충전   |     필요함      |  필요없음   |
|   속도    |      느림       |    빠름     |
|   가격    |     저렴함      |    비쌈     |
|  집적도   |      높음       |    낮음     |
| 소비 전력 |      적음       |    높음     |
| 사용 용도 | 주기억장치(RAM) | 캐시 메모리 |



***SDRAM(Synchronous Dynamic RAM)***

SDRAM은 클럭신호와 동기화된, 발전된 DRAM이다. 클럭 타이밍에 맞춰 CPU와 정보를 주고받을 수 있음을 의미한다.

***DDR SDRAM(Double Data Rate SDRAM)***

DDR SDRAM은 최근 가장 흔히 사용되는 RAM이다. DDR SDRAM은 대역폭을 넓혀 속도를 빠르게 만든 SDRAM이다. **대역폭**이란 '데이터를 주고받는 길의 너비'를 의미한다.

 ![5-2](https://github.com/JeongHwan0208/Computer-Instruction-operating-system/blob/main/Linux/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%20image/5-2.jpg)

한 클럭에 하나씩 정보를 주고받을 수 있는 SDRAM과 비교했을 때 DDR SDRAM은 너비가 두배인 도로와 같다. 즉, 한 클럭에 한 번씩 CPU와 데이터를 주고받을 수 있는 SDRAM에 비해 DDR SDRAM은 두배로 한 클럭당 두 번씩 CPU와 데이터를 주고받을 수 있다. 이런 이유로 한 클럭당 하나씩 데이터를 주고받을 수 있는 SDRAM을 **SDR SDRAM**라 부르기도 한다.

### 06-2 메모리 주소 공간

![5-3](https://github.com/JeongHwan0208/Computer-Instruction-operating-system/blob/main/Linux/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%20image/5-3.jpg
)

**물리 주소** : 메모리 하드웨어가 사용하는 주소

**논리 주소** : CPU와 실행 중인 프로그램이 사용하는 주소



**물리 주소와 논리 주소**

***주소***

- **물리 주소** : 실제로 저장된 하느뒈어상의 주소를 의미
- **논리 주소** : 실행 중인 프로그램 각각에게 부여된 0번지부터 시작되는 주소를 의미



논리 주소와 물리 주소 간의 변환은 CPU와 주소 버스 사이에 위치한 **메모리 관리 장치(MMU)**라는 하드웨어에 의해 수행된다.

![5-4](https://github.com/JeongHwan0208/Computer-Instruction-operating-system/blob/main/Linux/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%20image/5-4.jpg)

MMU는 CPU가 발생시킨 논리 주소에 베이스 레지스터 값을 더하여 논리 주소를 물리 주소로 변환한다.

**베이스 레지스터** : 프로그램의 가장 작은 물리 주소, 즉 프로그램의 첫 물리주소를 저장한다.

**논리 주소** : 프로그램의 시작점으로부터 떨어진 거리이다.



**메모리 보호 기법**

프로그램의 논리 주소 영역을 벗어나는 명령어들은 실행되어서는 안 된다. 이런 명령어들이 실행 된다면 명령어는 자신과는 전혀 관련없는 프로그램에 실행된다. 이런 명령어들의 실행을 방지하고 실행 중인 프로그램이 다른 프로그램에 영향을 받지 않도록 보호할 방법이 필요하다. 이는 **한계 레지스터**라는 레지스터가 담당합니다.

![5-5](https://github.com/JeongHwan0208/Computer-Instruction-operating-system/blob/main/Linux/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%20image/5-5.jpg
)

CPU는 메모리에 접근하기 전에 접근하고자 하는 논리 주소가 한계 레지스터보다 작은지를 항상 검사한다. 만약 CPU가 한계 레지스터보다 높은 논리 주소에 접근하려고 하면 인터럽트(트랩)을 발생시켜 중단한다.

### 06-3 캐시 메모리

CPU는 프로그램을 실행하는 과정에서 메모리에 저장된 데이터를 빈번하게 사용한다. 하지만 CPU가 메모리에 접근하는 시간은 CPU의 연산 속도보다 느리다. CPU가 연산을 빨리 한다 해도 메모리에 접근하는 시간이 느리면 CPU의 빠른 연산 속도는 의미가 없다. 이를 극복하기 위한 장치가 **캐시 메모리**이다.

**저장 장치 계층 구조**

저장 장치가 일반 적으로 따르는 명제

1. CPU와 가까운 저장 장치는 빠르고, 멀리 있는 저장 장치는 느리다.
2. 속도가 빠른 저장 장치는 용량이 작고, 가격이 비싸다.

![5-6](https://github.com/JeongHwan0208/Computer-Instruction-operating-system/blob/main/Linux/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%20image/5-6.jpg)

컴퓨터가 사용하는 저장 장치들은 'CPU에 얼마나 가까운가'를 기준으로 계층적으로 나타낸 것을 **저장 장치 계층 구조**라고 한다.

**캐시 메모리**

캐시 메모리는 CPU와 메모리 사이에 위치하고, 레지스터보다 용량이 크고 메모리보다 빠른 SRAM 기반의 저장 장치이다.

![5-7](https://github.com/JeongHwan0208/Computer-Instruction-operating-system/blob/main/Linux/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/%EC%BB%B4%ED%93%A8%ED%84%B0%20%EA%B5%AC%EC%A1%B0%20%26%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%20image/5-7.jpg)

캐시 메모리는 CPU의 연산 속도와 메모리 접근 속도의 차이를 조금이나마 줄이기 위해 탄생했다. CPU가 매번 메모리에 왔다 갔다 하는 건 시간이 오래 걸리니, 메모리에서 CPU가 사용할 일부 데이터를 미리 캐시 메모리로 가지고 와서 활용하는 것이다.

컴퓨터 내부에는 여러 개의 캐시 메모리가 있다. 그리고 이 캐시 메모리들은 CPU(코어)와 가까운 순서대로 계층을 구성한다.

- L1캐시 : 코어와 가장 가까운 캐시 메모리
- L2캐시 : 코어와 두 번째로 가까운 캐시 메모리
- L3캐시 : 코어와 세 번째로 가까운 캐시 메모리

**참조 지역성 원리**

캐시 메모리는 CPU가 사용할 법한 대상을 예측하여 저장한다.

**캐시 히트** : 예측한 데이터가 실제로 들어맞아 캐시 메모리 내 데이터가 CPU에서 활용 될 경우

**캐시 미스** : 예측이 틀려 메모리에서 필요한 데이터를 직접 가져와야 하는 경우
$$
캐쉬 적중률 = 캐시 히트 횟수 / (캐시 히트 횟수 + 캐시 미스 횟수)
$$
**참조 지역성 원리** : 캐시 메모리가 가져올 데이터를 결정할 때 따르는 원칙

***1. 시간 지역성*** : '최근에 접근했던 메모리 공간에 다시 접근하려는 경향'

***2. 공간 지역성*** : '접근한 메모리 공간 근처를 접근하려는 경향'
